---
title: "Electricity Production in Romania"
output: html_document
date: '`r Sys.Date()`'
---

```{r}
#initial setup & files
library(plyr)
library(reshape2)
library(tidyverse)

setwd("/Users/home/Downloads/5. Github Public Repos/Daily-Electricity-in-Romania--2019-2023--EDA")
romaniaElectricity <- read.csv("datasets/daily_electricity_data.csv")
romaniaElectricity <- romaniaElectricity %>%
  mutate(DateTime = as.Date(DateTime)) %>%
  filter(DateTime < "2023-01-01")
```

```{r}
#Types of potential graphs:
#-barplot of production by year + by category(stacked)
#-timeseries plot of net electricity production (if negative - country is importing elecricity, if positive - exporting)
#-mean electricity production by technology type (transform the data to get categorical var)
```

```{r}
#exploring the data a little bit
head(romaniaElectricity)
str(romaniaElectricity) 
#DateTime needs to be a date var
#also need to take individual columns with different electricity production tech into two columns: tech and production_num
```


```{r}
#graph1 production by year

productionByYear <- romaniaElectricity %>%
  mutate(Year = format(DateTime, "%Y")) %>%
  group_by(Year) %>%
  mutate(Total_Consumption = sum(Consumption),
    Total_Production = sum(Production),
    Total_Nuclear = sum(Nuclear),
    Total_Wind = sum(Wind),
    Total_Hydroelectric = sum(Hydroelectric),
    Total_OilAndGas = sum(Oil.and.Gas),
    Total_Coal = sum(Coal),
    Total_Solar = sum(Solar),
    Total_Biomass = sum(Biomass)) %>%
  select(Year, Total_Production,
            Total_Nuclear, Total_Wind, Total_Hydroelectric,
            Total_OilAndGas, Total_Coal, Total_Solar, Total_Biomass) %>%
  summarise_all(mean)

productionByYear <- melt(productionByYear, 
                         id.vars = c("Year", "Total_Production"),
                         variable.name = "Technology",
                         value.name = "Technology_Production") %>%
  arrange(Year)

ggplot(productionByYear, aes(x = Year, y = Technology_Production, fill = Technology)) + 
  geom_bar(stat = "identity") +
  labs(x = "Year",
       y = "Electricity Production (MWhrs)",
       title = "Electricity Production in Romania (2019-2022)",
       subtitle = "source: data.world") +
  theme()
```

```{r}
#graph2 net electricity
netElectricity <- romaniaElectricity %>%
  select(DateTime, Production, Consumption) %>%
  mutate(NetProduction = Production - Consumption,
         Exporting = NetProduction > 0) %>%
  select(DateTime, NetProduction, Exporting) %>%
  mutate(Exporting = factor(Exporting, levels = c("TRUE", "FALSE")))


ggplot(netElectricity, aes(x = DateTime, y = NetProduction, color = Exporting)) + 
  geom_col() +
  labs(title = "Net Electricity Production in Romania (2019-2022)")
```

```{r}
#graph3 mean production by technology
productionByTechnology <- productionByYear %>%
  group_by(Technology) %>%
  summarise(Mean_Technology_Production = mean(Technology_Production))

#renaming the levels in the factor
productionByTechnology$Technology <- revalue(productionByTechnology$Technology,
                                             c("Total_Nuclear" = "Nuclear",
                                               "Total_Wind" = "Wind",
                                               "Total_Hydroelectric" = "Hydroelectric",
                                               "Total_OilAndGas" = "Oil and Gas",
                                               "Total_Coal" = "Coal",
                                               "Total_Solar" = "Solar",
                                               "Total_Biomass" = "Biomass"))

#sorting the levels in factor


ggplot(productionByTechnology, aes(x = Mean_Technology_Production, y = fct_reorder(Technology, Mean_Technology_Production))) +
  geom_bar(stat = "identity") +
  labs(title = "Mean Electricity Production by Technology in Romania (2019-2022)",
       subtitle = "source: data.world",
       x = "Production (MWh)",
       y = "")
```


